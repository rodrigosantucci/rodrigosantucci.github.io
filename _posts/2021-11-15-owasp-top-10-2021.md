---
layout: post
title: "OWASP Top 10 (2021)"
date: 2021-11-15
excerpt: "Principais vulnerabilidades e como mitigá-las."
tags: [seguranca, owasp, web]
comments: true
min_read_time: 20
auto_content: true
feature: "assets/img/logopost.jpg"
---

Validação de entrada, autenticação e gestão de segredos.

Ferramentas de análise estática.

## Decisão e Contexto

- Objetivo: reduzir exposição às principais vulnerabilidades do OWASP Top 10 (2021) em apps web.
- Escopo: APIs REST/GraphQL, aplicações SPA/SSR, serviços backend e integrações.
- Métricas: taxa de falhas em testes de segurança, vulnerabilidades por release, tempo de correção.

## Top 10 com Mitigações

- Broken Access Control: autorize por recurso/ação; use ABAC/RBAC; valide `ownerId` no backend; negue por padrão.
- Cryptographic Failures: force TLS 1.2+; não usar algoritmos inseguros; rotacione chaves; use KMS/HSM.
- Injection: use ORM com prepared statements; validação do input; evitar concatenação de SQL; sanitizar comandos.
- Insecure Design: ameace-modelo; princípios de mínimo privilégio; fluxos seguros por padrão; revisões arquiteturais.
- Security Misconfiguration: hardening e baseline; infraestrutura como código; varrer configurações; `deny all` default.
- Vulnerable and Outdated Components: SCA/SBOM; políticas de atualização; bloquear versões com CVEs.
- Identification and Authentication Failures: MFA; senhas hash com `bcrypt/scrypt/Argon2`; lockout; sessões seguras.
- Software and Data Integrity Failures: assinar artefatos; verificação de integridade; pipelines confiáveis.
- Security Logging and Monitoring Failures: logs estruturados; correlação; retenção e alertas; trilhas de auditoria.
- Server-Side Request Forgery (SSRF): validação de destinos; permitir‑list; metadados cloud isolados; proxies seguros.

## Exemplo

```sql
-- Seguro: prepared statements
SELECT * FROM users WHERE email = $1;
```

```bash
# Política de bloqueio de versão vulnerável (exemplo SCA)
echo "reject express@4.17.1" >> policies/.sca-blocklist
```

## Checklist

- Validar autorização por recurso; negar por padrão.
- Usar SAST/DAST/SCA em pipeline.
- Criptografia adequada; rotação e armazenamento de segredos.
- Logs de segurança e alertas; resposta a incidentes.

## Estudo de Caso

- Migração de autenticação para OIDC com PKCE; introdução de RBAC por domínio; pipeline com SCA+SAST.

## Referências

- OWASP Top 10: https://owasp.org/www-project-top-ten/
- Cheat Sheets: https://cheatsheetseries.owasp.org/
- ASVS: https://owasp.org/www-project-application-security-verification-standard/

